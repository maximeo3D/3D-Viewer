<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>3D Viewer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
    <script src="https://cdn.babylonjs.com/hdr/babylonjs.hdr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.9/dat.gui.min.js"></script>
    <script src="datGUI.js"></script>
    <script>
        // Contrôle de visibilité de la sidebar
        const showSidebar = true; // Changez true/false pour afficher/cacher la sidebar
        
        // Configuration par défaut
        const defaultConfig = {
            options: 'option1',
            materials: 'config1'
        };
    </script>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-content">
                <div class="category">
                    <h3>Options</h3>
                    <div class="buttons">
                        <button class="sidebar-btn" id="option1-btn">Option 1</button>
                        <button class="sidebar-btn" id="option2-btn">Option 2</button>
                        <button class="sidebar-btn" id="option3-btn">Option 3</button>
                    </div>
                </div>
                
                <div class="category">
                    <h3>Material Configs</h3>
                    <div class="buttons">
                        <button class="sidebar-btn" id="config1-btn">Config 1 (Red/Blue)</button>
                        <button class="sidebar-btn" id="config2-btn">Config 2 (Blue/Red)</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="canvas-container">
            <canvas id="renderCanvas"></canvas>
        </div>
    </div>
    <script src="scene.js"></script>
    <script>
        // Connecter les boutons HTML au système de tags
        document.addEventListener('DOMContentLoaded', function() {
            // Attendre que le TagManager soit initialisé
            setTimeout(() => {
                if (window.tagManager) {
                    // Boutons d'options (sélection exclusive)
                    document.getElementById('option1-btn').addEventListener('click', () => {
                        window.tagManager.setOption('option1');
                        updateButtonStates();
                    });
                    
                    document.getElementById('option2-btn').addEventListener('click', () => {
                        window.tagManager.setOption('option2');
                        updateButtonStates();
                    });
                    
                    document.getElementById('option3-btn').addEventListener('click', () => {
                        window.tagManager.setOption('option3');
                        updateButtonStates();
                    });
                    
                    // Boutons de configuration de matériaux
                    document.getElementById('config1-btn').addEventListener('click', () => {
                        window.tagManager.applyMaterialConfig('object1', 'config1');
                        updateButtonStates();
                    });
                    
                    document.getElementById('config2-btn').addEventListener('click', () => {
                        window.tagManager.applyMaterialConfig('object1', 'config2');
                        updateButtonStates();
                    });
                    
                    // Appliquer la configuration par défaut
                    window.tagManager.setOption(defaultConfig.options);
                    window.tagManager.applyMaterialConfig('object1', defaultConfig.materials);
                    
                    // Mettre à jour l'état initial des boutons
                    updateButtonStates();
                }
            }, 1000);
            
            function updateButtonStates() {
                if (!window.tagManager) return;
                
                const activeTags = window.tagManager.getActiveTags();
                
                // Reset all buttons
                document.querySelectorAll('.sidebar-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Activate tag buttons
                activeTags.activeTags.forEach(tag => {
                    const btn = document.getElementById(`${tag}-btn`);
                    if (btn) {
                        btn.classList.add('active');
                    }
                });
                
                // Activate material config button
                if (activeTags.material) {
                    const btn = document.getElementById(`${activeTags.material.configName}-btn`);
                    if (btn) {
                        btn.classList.add('active');
                    }
                }
            }
        });
    </script>
</body>
</html>
